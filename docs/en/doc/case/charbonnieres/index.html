<!DOCTYPE html>
<html lang="en">

  <head>
    
	    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]                  
    }
  };
</script>



    

    <meta charset="utf-8">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>The Charbonni√®res stream</title>
<meta name="author" content="" />





<meta name="description" content="">

<meta name="generator" content="Hugo 0.122.0">


<link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>


<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link href="/css/animate.css" rel="stylesheet">



  <link href="/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">



<link href="/css/custom.css?1713520952" rel="stylesheet">



  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->



<link rel="shortcut icon" href="/img/logo.png" type="image/x-icon" />
<link rel="apple-touch-icon" href="/img/logo.png" />


<link rel="alternate" href="https://baratin-tools.github.io/index.xml" type="application/rss+xml" title="BaRatin - Bayesian Rating Curves">








<meta property="og:locale" content="en">
<meta property="og:site_name" content="BaRatin - Bayesian Rating Curves">
<meta property="og:title" content="The Charbonni√®res stream">
<meta property="og:type" content="website">
<meta property="og:url" content="https://baratin-tools.github.io/en/doc/case/charbonnieres/" />
<meta property="og:description" content="">
<meta property="og:image" content="https://baratin-tools.github.io/img/logo.png">
<meta property="og:image:type" content="image/png">



  <meta property="og:image:width" content="145">
  <meta property="og:image:height" content="145">






<meta name="twitter:card" content="summary">

<meta name="twitter:title" content="The Charbonni√®res stream">

<meta name="twitter:image" content="https://baratin-tools.github.io/img/logo.png">

<meta name="twitter:description" content="">


  </head>

  <body>

    <div id="all">

        


        <header class="navbar-affixed-top" data-spy="affix" data-offset-top="62">
    <div class="navbar navbar-default yamm " role="navigation" id="navbar">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/en/">
                    
                      <img src="/img/logoWithText.png" alt="The Charbonni√®res stream logo" class="hidden-xs hidden-sm" />
                      <img src="/img/logo.png" alt="The Charbonni√®res stream logo" class="visible-xs visible-sm" />
                    
                    <span class="sr-only">The Charbonni√®res stream - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  

                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en">Home</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                    
                    
                    <li class="dropdown ">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
                        
                        <ul class="dropdown-menu">
                            
                            <li><a href="/en/doc/baratinage">BaRatinAGE v3</a></li>
                            
                            <li><a href="/en/doc/topics">Topic sheets</a></li>
                            
                            <li><a href="/en/doc/case">Case Studies</a></li>
                            
                        </ul>
                        
                    </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/resources">Resources</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/blog">Blog</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/about">About</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/index.xml">rss</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/fr">üá´üá∑ fr</a>
                  </li>
                  
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</header>




        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>The Charbonni√®res stream</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-10" id="blog-post">

                        <div id="post-content">
                          

<div id="TOC">
<ul>
<li><a href="#hydraulic-analysis" id="toc-hydraulic-analysis"><span class="toc-section-number">1</span> Hydraulic analysis</a></li>
<li><a href="#prior-specification" id="toc-prior-specification"><span class="toc-section-number">2</span> Prior specification</a></li>
<li><a href="#gaugings-and-posterior-rating-curve" id="toc-gaugings-and-posterior-rating-curve"><span class="toc-section-number">3</span> Gaugings and posterior rating curve</a></li>
<li><a href="#alternative-approaches" id="toc-alternative-approaches"><span class="toc-section-number">4</span> Alternative approaches</a></li>
</ul>
</div>

<blockquote>
<p>Download the BaRatinAGE file for this case study: <a href="/bam/Charbonnieres-CharbonnieresLesBains.bam">Charbonnieres-CharbonnieresLesBains.bam</a></p>
</blockquote>
<div id="hydraulic-analysis" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Hydraulic analysis</h1>
<p>This <a href="https://bdoh.irstea.fr/YZERON/station/V301502301">station</a> is part of the <a href="https://bdoh.irstea.fr/YZERON/">Yzeron observatory</a> monitoring several peri-urban catchments around the city of Lyon since 1997. A ‚Äútruncated triangle‚Äù weir is used at this station. This geometry is used quite frequently in practice, but its modelling within BaRatin is not straightforward because its <span class="math inline">\(Q(H)\)</span> equation is not compatible with some BaRatin hypotheses. This case study therefore aims at illustrating a possible way to make BaRatin-compliant approximations for this particular geometry.</p>
<img src="CharboAnalysis.jpg" width="90%">
<p style="text-align: center;color: gray;">
Figure 1. Analysis of hydraulic controls for the Charbonni√®res stream at Charbonni√®res-Les-Bains. Top: photo taken from downstream, showing the ‚Äútruncated triangle‚Äù inserted in a larger rectangular weir (photo: M. Lagouy); bottom: schematics of a ‚Äútruncated triangle‚Äù weir considered in isolation.
</p>
<p>The problematic part of this hydraulic configuration is the ‚Äútruncated triangle‚Äù weir, schematized in Figure 1: a regular triangular weir laterally expands up to a given stage <span class="math inline">\(b&#39;\)</span>, then is framed with vertical walls. The equation of this control above stage <span class="math inline">\(b&#39;\)</span> is given below. It can be interpreted as the addition of a ¬´ negative ¬ª triangular weir equation to remove the excess wetted area of the regular triangle when it reaches the vertical walls.</p>
<p><span class="math display">\[
Q(H)=\underbrace{C_t \sqrt{2g}\tan({\nu/2})}_{a_1}(H-b)^c - \underbrace{C_t \sqrt{2g}\tan({\nu/2})}_{a_2}(H-b&#39;)^c
\]</span></p>
<p>This equation is not BaRatin-compliant for the following reasons:</p>
<ol style="list-style-type: decimal">
<li>It cannot be factorized as a single power equation <span class="math inline">\(Q(H)=a(H-b)^c\)</span></li>
<li>Using a subtraction of two controls as suggested by the equation does not work because:
<ol style="list-style-type: lower-alpha">
<li>BaRatin does not allow subtracting power equations, only adding them up; it would then be tempting to add a control with a negative coefficient <span class="math inline">\(a&#39;_2=-a_2\)</span>, but BaRatin does not allow negative coefficients either.</li>
<li>The parameters of the two controls that should be subtracted are linked: in particular, they have the same coefficients <span class="math inline">\((a_1=a_2)\)</span> and the same exponent <span class="math inline">\(c\)</span>. BaRatin has no functionality to enforce such links.</li>
</ol></li>
</ol>
<p>These constraints that BaRatin enforces are a consequence of the <a href="/en/doc/topics/rating-curve/">general formulation of the rating curve equation</a> and in particular the need to solve a continuity equation. Two possible approaches to circumvent these constraints are currently under investigation and are described at the end of this page. In the meantime, it is possible to use an approximation to make this type of control compliant with the BaRatin framework. A possible approximation is to use a triangular weir for stage values lower than <span class="math inline">\(b&#39;\)</span>, then to replace it with a rectangular weir for stage values higher than <span class="math inline">\(b&#39;\)</span>. The bottom stage of this rectangle (offset) should be estimated above the offset of the triangle, and the advantage of the rectangle weir is that its exponent <span class="math inline">\(c=1.5\)</span> is more in line with the laterally-constrained geometry (compare it with the triangle exponent <span class="math inline">\(c=2.5\)</span>). It might also be desired in some situations to smooth the transition between the triangle and the rectangle. A parabolic weir may be used for this purpose, with an offset in between those of the triangle and the rectangle and dimensions to be adapted to the studied control.</p>
<p>Going back to the specific case of the Charbonni√®res stream, we opt for the following approximate configuration (leading to the control matrix below):</p>
<ol style="list-style-type: decimal">
<li>Triangular weir for <span class="math inline">\(H&lt;b&#39;\)</span></li>
<li>Replacement by an equivalent rectangular weir for <span class="math inline">\(H \geq b&#39;\)</span></li>
<li>Addition of a wide rectangular weir representing the large rectangle into which the truncated triangle is inserted for <span class="math inline">\(H \geq b&#39;\)</span></li>
</ol>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
\hline
  \text{Control} &amp; \text{Nature} &amp; \text{Type} \\
\hline
     1 &amp; \text{Triangular weir} &amp; \text{section} \\
\hline
     2 &amp; \text{Rectangular weir approximating the truncated triangle} &amp; \text{section} \\
\hline
     3 &amp; \text{Large rectangular weir} &amp; \text{section} \\
\hline
\end{array}
\]</span></p>
<p><span class="math display">\[
\begin{array}{|c|}
\hline
  &amp;\text{control 1} &amp; \text{control 2} &amp; \text{control 3}\\
\hline
  \text{segment 1} &amp;\color{lime}{1} &amp; &amp;\\
\hline
  \text{segment 2} &amp; \color{darkslategray}{0} &amp; \color{lime}{1} &amp;\\
\hline
  \text{segment 3} &amp; \color{darkslategray}{0} &amp; \color{lime}{1} &amp; \color{lime}{1} \\
\hline
\end{array}
\]</span></p>
</div>
<div id="prior-specification" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Prior specification</h1>
<p>Once the hydraulic configuration has been defined, prior specification can proceed as follows:</p>
<ul>
<li>Control 1 (triangle) activates at <span class="math inline">\(\kappa = 7.2 \mathrm{cm} \pm 1 \mathrm{cm}\)</span> and the opening angle is equal to <span class="math inline">\(\nu = 90¬∞ \pm 2¬∞\)</span></li>
<li>Control 2 (rectangle approximating the truncated triangle) activates at <span class="math inline">\(\kappa = 40.3 \mathrm{cm} \pm 0.5 \mathrm{cm}\)</span> and its width is equal to <span class="math inline">\(B_w = 70 \mathrm{cm} \pm 3 \mathrm{cm}\)</span></li>
<li>Control 3 (wide rectangle added to the rectangle above) activates at <span class="math inline">\(\kappa = 40.4 \mathrm{cm} \pm 3 \mathrm{cm}\)</span>. In theory one would wish to specify an activation stage equal to the previous one, but in practice it is specified <span class="math inline">\(1 \mathrm{mm}\)</span> above to avoid an error message due to the fact that BaRatin requires strictly increasing activation stages. This wide rectangle has a width equal to <span class="math inline">\(B_w = 467 \mathrm{cm} \pm 2 \mathrm{cm}\)</span></li>
</ul>
<p>The prior rating curve resulting from these specifications is shown below and is already fairly precise, as is often the case when artificial weirs are used.</p>
<br>
<img src="CharboPrior.en.svg" width="75%">
<p style="text-align: center;color: gray;">
Figure 2. Prior rating curve for the Charbonni√®res stream at Charbonni√®res-Les-Bains (note the log y-axis for discharge).
</p>
</div>
<div id="gaugings-and-posterior-rating-curve" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Gaugings and posterior rating curve</h1>
<p>88 gaugings are available to estimate the posterior rating curve. The highest ones (around <span class="math inline">\(2 \mathrm{m}^3.\mathrm{s}^{‚àí1}\)</span>) correspond to fairly frequent flood events, and are much smaller than the highest discharges observed at this station (discharge for the November 2016 flood was estimated around ten times larger). The posterior rating curve indicates that gaugings allowed reducing the uncertainty for low to medium flows, but extrapolation toward higher flows remains very uncertain.</p>
<br>
<img src="CharboPosterior.en.svg" width="100%">
<p style="text-align: center;color: gray;">
Figure 3. Posterior rating curve for the Charbonni√®res stream at Charbonni√®res-Les-Bains (note the log y-axis for discharge).
</p>
<p>A more thorough analysis of estimated parameters indicates that the bottom of the rectangle approximating the truncated triangle lies at <span class="math inline">\(b_2=22 \mathrm{cm}\)</span>, wich is above the bottom of the triangle <span class="math inline">\((b_1=7 \mathrm{cm})\)</span> but below the bottom of the wide rectangle <span class="math inline">\((b_3=41 \mathrm{cm})\)</span>. The Figure below illustrates the geometry resulting from the posterior parameter estimates.</p>
<br>
<img src="geometry.svg" width="75%">
<p style="text-align: center;color: gray;">
Figure 4. Estimated geometries for the triangle (active for <span class="math inline">\(H &lt; 41 \mathrm{cm}\)</span>) and the equivalent rectangle (replacing the triangle when <span class="math inline">\(H \geq 41 \mathrm{cm}\)</span>).
</p>
</div>
<div id="alternative-approaches" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Alternative approaches</h1>
<p>Two alternative approaches are currently being investigated to allow using controls such as the Charbonni√®res one that do not fit into the BaRatin framework. These two approaches are not yet available in BaRatinAGE, but they have already been implemented in <a href="/en/doc/case/rbam">RBaM</a>. We are currently working on documenting them and we will propose illustrative case studies soon. These two approaches are as follows:</p>
<ol style="list-style-type: decimal">
<li>Type the equation of the control: this can be done in RBaM by means of a specific model called <a href="https://github.com/BaM-tools/RBaM/blob/main/vignettes/TextFileModel.Rmd"><code>TextFileModel</code></a> which allows defining a new model ‚Äúon the fly‚Äù by just typing its equation.</li>
<li>Deduce the equation of the control from its bathymetry. This can be done for a section-type control by means of the model <code>HydraulicControl_section</code> implemented in RBaM and that is currently being documented.</li>
</ol>
<p>The two approaches above should enable estimating the parameters of a single arbitrary control. However, they do not enable the estimation of a combination of such arbitrary controls, as may be encountered in a multi-segment rating curve. As already mentioned earlier, solving the continuity equation may become difficult outside of the simple-power-law framework enforced by BaRatin. In particular, the solution of the continuity equation is in general not explicit, and its existence and unicity are not even ensured.</p>
</div>


                        </div>                        
                        
  <div class="container">
    
    

    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/ardeche-meyras/">Ard√®che River at Meyras</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/isere-grenoble/">Is√®re River at Grenoble-Campus</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/mercier-d610/">Mercier River at D610 road</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		   <strong> <a href="https://baratin-tools.github.io/en/doc/case/charbonnieres/">The Charbonni√®res stream</a> </strong> 

		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/rbam/">Using RBaM</a> 
		

		
		    &nbsp; | &nbsp;
		
    
         
  
  </div>
    




                    </div>
                    

                    

                    

                    <div class="col-md-2">

                        
                        
                        
  <div class="container">
  	<h3> Sections </h3>
    
    
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/ardeche-meyras/">Ard√®che River at Meyras : <br> a standard 3-control configuration</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/isere-grenoble/">Is√®re River at Grenoble-Campus : <br> single channel control</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/mercier-d610/">Mercier River at D610 road : <br> combination of artificial weirs</a> </br> </br>
		
    
		
		<div style="background-color:beige;">
		   <strong> <a href="https://baratin-tools.github.io/en/doc/case/charbonnieres/">The Charbonni√®res stream : <br> &#34;truncated triangle&#34; weir</a> </strong></br>
		</div>
		</br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/case/rbam/">Using RBaM : <br> BaRatin in R!</a> </br> </br>
		
    
         
  
  </div>
    





                        

                    </div>
                    

                    

                </div>
                

            </div>
            
            
            
        </div>
        

        <footer id="footer">
  <div class="container">
    
  
    <div class="col-xs-3">
    	<p> <strong> BaRatin</strong> - Bayesian Rating Curves </p>
        <p> <strong>Contact</strong>: baratin.dev %at% inrae.fr </p>
    </div>
  
    <div class="col-xs-3">
        <p> <a href="https://github.com/BaRatin-tools"> <img alt="GitHub logo" src="/img/github-mark.svg" width="24" height="24" /> https://github.com/BaRatin-tools </a> </p>
        <p> <a href="https://github.com/BaM-tools"> <img alt="GitHub logo" src="/img/github-mark.svg" width="24" height="24" /> https://github.com/BaM-tools </a> </p>
    </div>
  
    <div class="col-xs-3">
      <p> 
       <a href="https://www.inrae.fr"><img style="max-width:90%;max-height:40px;" src="/img/Logo-INRAE_Transparent.png" alt="INRAE"> </a>
      </p>   
    </div>
    
    <div class="col-xs-3">
      <p> 
       <a href="https://gdh-hydrometrie.org/"><img style="max-width:90%;max-height:76px;" src="/img/Logo-GDH.png" alt="GDH"> </a>
      </p>   
    </div>
      
  </div>
    
</footer>




    </div>
    

    
<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>


<script src="/js/front.js"></script>



  </body>
</html>
