<!DOCTYPE html>
<html lang="en">

  <head>
    
	    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]                  
    }
  };
</script>



    

    <meta charset="utf-8">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Hydraulic configuration</title>
<meta name="author" content="" />





<meta name="description" content="">

<meta name="generator" content="Hugo 0.122.0">


<link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>


<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link href="/css/animate.css" rel="stylesheet">



  <link href="/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">



<link href="/css/custom.css?1710525651" rel="stylesheet">



  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->



<link rel="shortcut icon" href="/img/logo.png" type="image/x-icon" />
<link rel="apple-touch-icon" href="/img/logo.png" />


<link rel="alternate" href="https://baratin-tools.github.io/index.xml" type="application/rss+xml" title="BaRatin - Bayesian Rating Curves">








<meta property="og:locale" content="en">
<meta property="og:site_name" content="BaRatin - Bayesian Rating Curves">
<meta property="og:title" content="Hydraulic configuration">
<meta property="og:type" content="website">
<meta property="og:url" content="https://baratin-tools.github.io/en/doc/baratinage/hydraulic-configuration/" />
<meta property="og:description" content="">
<meta property="og:image" content="https://baratin-tools.github.io/img/logo.png">
<meta property="og:image:type" content="image/png">



  <meta property="og:image:width" content="145">
  <meta property="og:image:height" content="145">






<meta name="twitter:card" content="summary">

<meta name="twitter:title" content="Hydraulic configuration">

<meta name="twitter:image" content="https://baratin-tools.github.io/img/logo.png">

<meta name="twitter:description" content="">


  </head>

  <body>

    <div id="all">

        


        <header class="navbar-affixed-top" data-spy="affix" data-offset-top="62">
    <div class="navbar navbar-default yamm " role="navigation" id="navbar">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/en/">
                    
                      <img src="/img/logoWithText.png" alt="Hydraulic configuration logo" class="hidden-xs hidden-sm" />
                      <img src="/img/logo.png" alt="Hydraulic configuration logo" class="visible-xs visible-sm" />
                    
                    <span class="sr-only">Hydraulic configuration - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  

                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en">Home</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                    
                    
                    <li class="dropdown ">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
                        
                        <ul class="dropdown-menu">
                            
                            <li><a href="/en/doc/baratinage">BaRatinAGE v3</a></li>
                            
                            <li><a href="/en/doc/topics">Topic sheets</a></li>
                            
                            <li><a href="/en/doc/case">Case Studies</a></li>
                            
                        </ul>
                        
                    </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/resources">Resources</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/blog">Blog</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/about">About</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/en/index.xml">rss</a>
                  </li>
                  
                  
                  
                  

                  

                  

                  

                  
                  <li class="dropdown ">
                    <a href="/fr">üá´üá∑ fr</a>
                  </li>
                  
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</header>




        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>Hydraulic configuration</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-10" id="blog-post">

                        <div id="post-content">
                          


<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The hydraulic configuration is the definition of all the controls that govern the physical stage-discharge relation, and their succession/combination as the water level increases. It plays a vital role in an analysis with BaRatinAGE because it determines the equation that will be used for the rating curve.</p>
<p>The specification of a hydraulic configuration must result from a hydraulic analysis of the operation of the hydrometric station. For a natural river, for example, the following situation is frequently encountered: at low flows, the stage-discharge relation is controlled by the geometry of a critical cross-section at one or more weirs (natural or artificial). When the water level rises, all the weirs get submerged and the stage-discharge relation is then controlled by the average geometry and roughness of the low-flow channel (or main channel). For an even greater water level, part of the flow may take place in a floodway or over the banks of the main channel: the stage-discharge relation is then controlled by two channels, the low-flow channel and the floodway.</p>
<p>BaRatinAGE formalises this hydraulic analysis for a wide variety of situations, which cover the vast majority of practical cases encountered in natural rivers (while making a few acceptable approximations).
The recommended practice in BaRatinAGE is to break down the real critical cross-sections into a combination of idealised weirs or orifices, and the real controlling channels into a combination of wide, rectangular channels. Each control introduced must correspond to physical elements that can be clearly identified in the field. For details on the hydraulic analysis of a hydrometric station, you may refer to <a href="/en/doc/topics/hydraulic-analysis">this document</a>.</p>
</div>
<div id="creating-a-hydraulic-configuration" class="section level1">
<h1>Creating a hydraulic configuration</h1>
<p>By default, a blank hydraulic configuration named <em>HC (1)</em> pre-exists and can be used. There are several ways of creating a new hydraulic configuration:</p>
<ul>
<li>via the menu <em>Components‚Ä¶ Create new hydraulic configuration</em>;</li>
<li>by right-clicking on the <img src="hydraulic_config.svg" style="display:inline-block"> <em>Hydraulic configuration</em> node in the explorer tree;</li>
<li>by clicking on the <img src="hydraulic_config_add.svg" style="display:inline-block"> button in the toolbar.</li>
</ul>
<p>You will be able to rename this new hydraulic configuration and enter a description. An existing hydraulic configuration can be duplicated or deleted.</p>
<p>In the <img src="control_matrix.svg" style="display:inline-block"> <em>Control matrix</em> tab, you must specify the number of hydraulic controls that make up this configuration, and how they activate or deactivate for each stage segment. By way of illustration, we will work on the classic example mentioned above, valid for the example of the Aisne River at Verri√®res, and create 3 controls (weir, low-flow channel, floodway):</p>
<p><img src="HydraulicConfig_Verrieres_1.en.png" /></p>
<p>The matrix that appears, known as the ‚Äúmatrix of controls‚Äù or ‚ÄúBonnifait matrix‚Äô (in honour of its venerable inventor), determines the way in which the controls follow on from or add to each other. Each row of the matrix corresponds to a stage segment, and each column to a hydraulic control. The matrix above can therefore be interpreted as follows:</p>
<ul>
<li>For segment 1 (the lowest stages, i.e.¬†low flows), only control 1 (the weir) is activated;</li>
<li>For segment 2 (intermediate stages), only control 2 (the low-flow channel) is activated;</li>
<li>For segment 3 (the highest stages, i.e.¬†high flows), only control 3 (the floodway) is activated.</li>
</ul>
<p>This matrix is not appropriate for the example considered here. In fact, for the third segment, the flow takes place in both the low-flow channel and the floodway. The control by the floodway should therefore be added to the control by the low-flow channel (instead of replacing it). We can specify this combination of controls by selecting, for the third segment, both control 2 (‚Äúlow-flow channel‚Äù) and control 3 (‚Äúfloodway‚Äù) as shown below:</p>
<p><img src="Matrix_Verrieres.en.png" width="60%"></p>
<p>It is possible to reverse the display of the control matrix, by unchecking the <em>Invert segments order</em> box, so that the lowest water segment appears at the bottom, and the highest water segment appears at the top:</p>
<p><img src="Matrix_Verrieres_mirror.en.png" width="60%"></p>
<p>Note 1: There are some restrictions on filling the control matrix (for example, a control that has been deactivated cannot reactivate on a higher segment, etc.), which explains why not all the boxes in the matrix are clickable.</p>
<p>Note 2: The information contained in the control matrix is sufficient to write the equation for the rating curve. For more details on this equation, please consult <a href="/en/doc/topics/rating-curve">this document</a>.</p>
</div>
<div id="specification-of-hydraulic-controls" class="section level1">
<h1>Specification of hydraulic controls</h1>
<p>The hydraulic analysis not only allows us to identify the different types of controls that govern the stage-discharge relation, as well as their succession/combination: it also allows an initial quantitative estimate (albeit potentially very uncertain) of the rating curve.</p>
<p>In BaRatinAGE, each control is associated with a stage (<span class="math inline">\(H\)</span>) - discharge (<span class="math inline">\(Q\)</span>) relation in the form of the basic equation:</p>
<p><span class="math inline">\(Q = a(H-b)^c\)</span> for <span class="math inline">\(H &gt; \kappa\)</span> (and <span class="math inline">\(Q = 0\)</span> if <span class="math inline">\(H \leq b\)</span>)</p>
<ul>
<li><span class="math inline">\(\kappa\)</span> is the <em>activation stage</em>; when the water level falls below the value <span class="math inline">\(k\)</span>, the control becomes inactive;</li>
<li><span class="math inline">\(a\)</span> is the <em>coefficient</em>, which depends on the physical properties of the control;</li>
<li><span class="math inline">\(c\)</span> is the <em>exponent</em>, which depends solely on the type of control;</li>
<li><span class="math inline">\(b\)</span> is the <em>offset</em>; when stage falls below the value <span class="math inline">\(b\)</span>, discharge is zero. Note that this parameter is generally different from the activation stage <span class="math inline">\(\kappa\)</span>. For example, for a channel control following a section control, parameter <span class="math inline">\(b\)</span> rthe average elevation of the channel bottom, but the control only activates when the weir is drowned, at a stage <span class="math inline">\(\kappa\)</span> which is different from <span class="math inline">\(b\)</span>.</li>
</ul>
<p>Each of these parameters can be related to physical characteristics of the control, as explained in detail in <a href="/en/doc/topics/hydraulic-controls">this document</a>. It is therefore possible to define approximate values for each parameter, and most importantly their (potentially large) uncertainty. We say we thus define prior parameters, the term prior being used here to mean that this first rough estimation can and must be done without using any gauging. Finally, note that in practice the definition of priors is done only for the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span>. Indeed, the continuity of the rating curve is a constraint which implies that the parameter <span class="math inline">\(b\)</span> is automatically deduced from the other three parameters.</p>
<p>The prior parameters are specified in the <img src="prior_densities.svg" style="display:inline-block"> <em>Prior parameter specification</em> tab, where each control is associated with a tab. Using the example considered so far, the characteristics of the first control can be specified by entering a description of the control, then selecting its type from the drop-down menu (here, <img src="hc_rect_weir.svg" style="display:inline-block"> <em>Rectangular weir</em>). The control‚Äôs hydraulic formula including its physical parameters is displayed to remind you of their link with the <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> parameters of the rating curve to be estimated.</p>
<p>You can enter uncertain values for the physical parameters in the fields at the top of the window. Some fields are pre-filled because they depend only on the type of control, but you can always change them if you wish. Note that throughout BaRatinAGE, uncertainties are expressed as 95% expanded uncertainties, i.e.¬†as the half-length of a 95% probability interval. For a Gaussian distribution, this corresponds to 1.96 times the standard deviation. Using the example of the Aisne at Verri√®res, the first control (weir) can be specified as follows:</p>
<p><img src="SpecPriors_Verrieres.en.png" /></p>
<p><br>
Once the fields for all the physical parameters of a control have been filled in, the values and uncertainties of the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are propagated to the fields at the bottom of the window. It is also possible to directly specify the prior distributions of the <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> parameters, by clicking on the <em>Switch to k, a, c parameters mode</em> button. In this case, unlike the <em>physical parameters mode</em>, it is possible to specify a distribution type other than Gaussian (from the choices offered in the drop-down menu), and the parameters of each distribution as well as the initial value that must be specified for the MCMC simulations. You can also select ‚ÄúFixed value‚Äù: in this case, the parameter will not be estimated but fixed at the specified value.</p>
<p><img src="SpecPriors_Verrieres_kac.en.png" />
<br>
You can proceed similarly for next control until all the controls have been completed. For the low-flow channel of the Aisne at Verri√®res:</p>
<p><img src="SpecPriors_Verrieres_2.en.png" />
<br>
And for the floodway:</p>
<p><img src="SpecPriors_Verrieres_3.en.png" /></p>
</div>
<div id="the-prior-rating-curve" class="section level1">
<h1>The prior rating curve</h1>
<p>Once the prior specifications have been carried out for all the controls, it is possible to draw an initial rating curve (with uncertainties), which we call the prior rating curve because it is carried out without the aid of any gauging. The calculation of the prior rating curve uses a Monte Carlo approach: samples of the parameters <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> of all the controls are generated using the uncertainties or distributions specified in the previous step. By generating a large number of samples, we obtain a large number of possible rating curves, which we use to calculate an uncertainty interval at a given probability level (95% in BaRatinAGE).</p>
<p>At the top of the <img src="prior_rating_curve.svg" style="display:inline-block"> <em>Prior rating curve</em> tab, you need to specify the parameters of the <em>stage grid</em> on which the <em>prior rating curve</em> is calculated:
- The minimum stage in the grid (in metres) ;
- The maximum stage in the grid (in metres);
- The number of stage steps (default: 100);
- The stage grid step (in metres).</p>
<p>The last two parameters are calculated automatically if the other three parameters are specified. The calculation time is proportional to the size of the grid, but is generally very short. Once all this information has been entered, you can launch the calculation by clicking on the <em>Compute prior rating curve</em> button. The prior rating curve should quickly appear in the graphics panel, as shown below:</p>
<p><img src="PriorRC_Verrieres.en.png" width="80%"></p>
<p>The parametric uncertainty (at the 95% probability level) around the <em>prior rating curve</em> is displayed in the form of a transparent blue envelope. Obviously, this prior curve will generally be very uncertain, but we will use the gaugings in the next step to reduce this uncertainty. The graph also represents the activation stages <span class="math inline">\(\kappa\)</span> of the various controls as purple vertical lines (with uncertainty). It is possible to transform the discharge axis into a logarithmic scale and swap the X/Y axes. You can open the graph in a new window, export the image in SVG or PNG format, or copy it to the clipboard. This visualization of the prior rating curve allows you to check the relevance and consistency of your prior assumptions about the controls.</p>
</div>
<div id="a-few-tips-for-specifying-priors" class="section level1">
<h1>A few tips for specifying priors:</h1>
<ul>
<li>First golden rule: <strong>do not use the gaugings</strong>. These will indeed be used in the next step, and using them also for ‚Äútuning‚Äù the prior curve would be using the same information twice: this is a guarantee to underestimate uncertainties! Also note that it is not possible to display gaugings in the prior rating curve graph (and it‚Äôs done on purpose!);</li>
<li>Second golden rule: <strong>be honest!</strong> You should not hesitate setting a large uncertainty when you do not know much about a parameter. Of course this will result in a very uncertain prior rating curve, but that curve is not the final curve since the information provided by the gaugings will be used in the next step to decrease the uncertainty. Here are some typical examples:
<ul>
<li>parameters that are often poorly known a priori: the activation stage of a control when it corresponds to the drowning of a weir; the geometric properties of a natural channel that is not very uniform along the controlling reach; the roughness of a natural channel (Strickler or Manning coefficient), etc.;</li>
<li>parameters that are often quite well known a priori: the geometric properties of an artificial structure or channel; the exponent c, which depends only on the type of control; discharge coefficients of artificial controlling sections (rectangle, triangle, orifice, etc.), etc.</li>
</ul></li>
</ul>
</div>


                        </div>                        
                        
  <div class="container">
    
    

    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/overview/">Overview</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/main-frame/">Main frame</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		   <strong> <a href="https://baratin-tools.github.io/en/doc/baratinage/hydraulic-configuration/">Hydraulic configuration</a> </strong> 

		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/gaugings/">Gaugings</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/structural-errors/">Structural error model</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/rating-curve/">Rating curve</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/stage-series/">Stage series</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/discharge-series/">Discharge series</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/going-further/">Going further</a> 
		

		
		    &nbsp; | &nbsp;
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/faq/">Frequently asked questions </a> 
		

		
    
         
  
  </div>
    




                    </div>
                    

                    

                    

                    <div class="col-md-2">

                        
                        
                        
  <div class="container">
  	<h3> Sections </h3>
    
    
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/overview/">Overview</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/main-frame/">Main frame</a> </br> </br>
		
    
		
		<div style="background-color:beige;">
		   <strong> <a href="https://baratin-tools.github.io/en/doc/baratinage/hydraulic-configuration/">Hydraulic configuration</a> </strong></br>
		</div>
		</br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/gaugings/">Gaugings</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/structural-errors/">Structural error model</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/rating-curve/">Rating curve</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/stage-series/">Stage series</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/discharge-series/">Discharge series</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/going-further/">Going further</a> </br> </br>
		
    
		
		    <a href="https://baratin-tools.github.io/en/doc/baratinage/faq/">Frequently asked questions </a> </br> </br>
		
    
         
  
  </div>
    





                        

                    </div>
                    

                    

                </div>
                

            </div>
            
            
            
        </div>
        

        <footer id="footer">
  <div class="container">
    
  
    <div class="col-xs-3">
    	<p> <strong> BaRatin</strong> - Bayesian Rating Curves </p>
        <p> <strong>Contact</strong>: baratin.dev %at% inrae.fr </p>
    </div>
  
    <div class="col-xs-3">
        <p> <a href="https://github.com/BaRatin-tools"> <img alt="GitHub logo" src="/img/github-mark.svg" width="24" height="24" /> https://github.com/BaRatin-tools </a> </p>
        <p> <a href="https://github.com/BaM-tools"> <img alt="GitHub logo" src="/img/github-mark.svg" width="24" height="24" /> https://github.com/BaM-tools </a> </p>
    </div>
  
    <div class="col-xs-3">
      <p> 
       <a href="https://www.inrae.fr"><img src="/img/Logo-INRAE_Transparent.png" alt="INRAE" height="40"> </a>
      </p>   
    </div>
    
    <div class="col-xs-3">
      <p> 
       <a href="https://gdh-hydrometrie.org/"><img src="/img/Logo-GDH.png" alt="GDH" height="76"> </a>
      </p>   
    </div>
      
  </div>
    
</footer>




    </div>
    

    
<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>


<script src="/js/front.js"></script>



  </body>
</html>
